CREATE TABLE v0 ( v1 ) ; CREATE VIEW v2 ( v3 ) AS SELECT v1 , SUM ( DISTINCT v1 * ( 0 - v1 ) ) AS REVENUE , v1 , v1 FROM v0 ; SELECT v3 FROM v2 UNION ALL SELECT COUNT ( * ) FROM v0 LIMIT 1 OFFSET 10 ; DROP TABLE v0 ; SELECT min ( v3 ) OVER( ) IN ( SELECT 0 UNION ALL SELECT 9223372036854775808 ) FROM v2 ; 